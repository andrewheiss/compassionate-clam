{
  "hash": "5feee60f5f024dccdf6245df715a3f61",
  "result": {
    "markdown": "---\ntitle: Exploratory and descriptive analysis\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(targets)\nlibrary(here)\nlibrary(sf)\nlibrary(ggrepel)\nlibrary(scales)\n\n# Point to the _targets folder location since this qmd is in a subfolder\ntar_config_set(store = here::here('_targets'),\n               script = here::here('_targets.R'))\n\n# Load targets\ntar_load(ongo)\nmapdata <- tar_read(ongo_mapdata)\ninvisible(list2env(tar_read(graphic_functions), .GlobalEnv))\nset_annotation_fonts()\n```\n:::\n\n\n# Timeline of ONGO registrations\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(ongo, aes(x = registration_date)) +\n  geom_histogram(binwidth = 365.25/4, boundary = ymd(\"2017-01-01\"), \n                 fill = clrs[6], color = \"white\") +\n  scale_x_date(date_breaks = \"years\", date_labels = \"%Y\") +\n  labs(x = NULL, y = \"Count of new ONGO registrations\") +\n  theme_ongo()\n```\n\n::: {.cell-output-display}\n![](exploratory_files/figure-html/plot-registration-timeline-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n# Distribution of outcome\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(ongo, aes(x = province_count)) +\n  geom_histogram(binwidth = 1, size = 0.1, boundary = 0,\n                 fill = clrs[6], color = \"white\") +\n  labs(x = \"Number of provinces INGOs are authorized to work in\", y = \"Count\") +\n  theme_ongo()\n```\n\n::: {.cell-output-display}\n![](exploratory_files/figure-html/province-count-distribution-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprovinces_collapsed <- ongo |> \n  drop_na(province_count) |> \n  mutate(province_count = case_when(\n    province_count == 1 ~ \"1 province\",\n    province_count > 1 & province_count < 32 ~ \"2â€“31 provinces\",\n    province_count == 32 ~ \"32 provinces\"\n  )) \n\nggplot(provinces_collapsed, aes(x = province_count)) + \n  geom_bar(fill = clrs[6]) +\n  scale_y_continuous(sec.axis = sec_axis(trans = ~ . / nrow(provinces_collapsed),\n                                         labels = label_percent())) +\n  labs(x = \"Number of provinces INGOs are authorized to work in\", y = \"Count\") +\n  theme_ongo()\n```\n\n::: {.cell-output-display}\n![](exploratory_files/figure-html/province-count-collapsed-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n# Issue areas\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nissue_count <- ongo |> \n  drop_na(work_field_code1) |> \n  group_by(work_field_code1) |>\n  summarize(n = n()) |> \n  mutate(work_field_code1 = fct_reorder(work_field_code1, n))\n\nggplot(issue_count, aes(y = work_field_code1, x = n)) +\n  geom_col(fill = clrs[5]) +\n  labs(x = \"Count of ONGOs\", y = NULL) +\n  theme_ongo()\n```\n\n::: {.cell-output-display}\n![](exploratory_files/figure-html/plot-ongo-issues-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n# Map of provinces and counts\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Use aes(geometry) and stat = \"sf_coordinates\" to make geom_label_repel() work\n# with geom_sf(): https://github.com/slowkow/ggrepel/issues/111#issuecomment-416853013\nggplot() +\n  geom_sf(data = mapdata, aes(fill = ro_count), \n          linewidth = 0.3, color = \"white\") +\n  scale_fill_distiller(palette = \"Reds\", direction = 1, guide = \"none\") +\n  geom_label_repel(data = filter(mapdata, ro_count > 0), \n                   aes(label = ro_count, geometry = geometry),\n                   stat = \"sf_coordinates\", seed = 1234, label.size = 0.1, size = 3,\n                   segment.color = \"black\", segment.size = 0.5, min.segment.length = 0) +\n  coord_sf(crs = st_crs(\"EPSG:4480\")) +  # China Geodetic Coordinate System 2000\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](exploratory_files/figure-html/ongo-map-1.png){fig-align='center' width=80%}\n:::\n:::\n",
    "supporting": [
      "exploratory_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}